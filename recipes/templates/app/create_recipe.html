{% extends "base/base_app.html" %}
{% load static widget_tweaks %}

{% block content %}
  <main class="app-page">
    <div class="container-lg">

      <div class="create-recipe-card">
        <h1 class="hero-title create-recipe-title">Create a recipe</h1>
        <p class="hero-lead create-recipe-lead">
          Give it a title, a short description, then list ingredients and steps.
        </p>

        <form method="post" enctype="multipart/form-data" data-form-bound="{{ form.is_bound|yesno:'true,false' }}" data-form-has-errors="{% if form.errors %}true{% else %}false{% endif %}" novalidate>
          {% csrf_token %}

          {% include "partials/forms/bootstrap_form.html" with form=form exclude_fields=exclude_fields %}

          <div class="shopping-links-helper mt-5 mb-4">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <div>
                <h5 class="mb-1 shopping-links-title text-dark">Shopping links</h5>
                <p class="text-muted small mb-0">Add items with links to appear in the shop section.</p>
              </div>
              <span class="text-secondary small fw-semibold">Optional</span>
            </div>

            <div class="row g-3 align-items-end shopping-links-row">
              <div class="col-12 col-md-5 col-lg-5 shopping-links-field">
                <label for="shop-item" class="form-label mb-1 text-muted small">Item Name</label>
                <input type="text" id="shop-item" class="form-control form-control-dark" placeholder="e.g. Matcha Powder">
              </div>
              <div class="col-12 col-md-5 col-lg-5 shopping-links-field">
                <label for="shop-link" class="form-label mb-1 text-muted small">Online Link</label>
                <input type="url" id="shop-link" class="form-control form-control-dark" placeholder="https://...">
              </div>
            </div>

            <div class="shopping-links-upload mt-3">
              <label class="form-label mb-1 text-muted small" for="{{ form.shop_images.id_for_label }}">Shopping images</label>
              {% render_field form.shop_images class="file-pill-input" %}
              <label for="{{ form.shop_images.id_for_label }}" class="file-pill-btn">Choose file</label>
              <small class="text-muted small d-block mt-1">{{ form.shop_images.help_text }}</small>
              <div id="shop-image-file-list" class="small text-muted mt-2"></div>
            </div>

            <div class="col-12 mt-3">
              <button type="button" id="add-shop-link" class="btn btn-white shop-add-btn">Add</button>
            </div>

            <div class="mt-4 shopping-links-list">
              <div class="small fw-bold text-muted mb-2 text-uppercase tracking-wide">Added Items</div>
              <div id="shop-list" class="shopping-list-box text-secondary small">No shopping links added yet.</div>
            </div>
          </div>

          <div class="small text-muted mb-2 mt-4">
            Tip: add tags like <code>#food</code>, <code>#dinner</code>, or <code>#private</code> in the tags field to control how your recipes are discovered.
          </div>

          <div class="mt-3 text-center">
            <button type="submit" class="btn-save-recipe">
              Post recipe
            </button>
          </div>
        </form>
      </div>

  </div>
  </main>

  <script src="{% static 'js/create_recipe_validation.js' %}"></script>
  <script src="{% static 'js/create_recipe_images.js' %}"></script>
  <script src="{% static 'js/create_recipe_shopping.js' %}"></script>
  <script src="{% static 'js/create_recipe_helpers.js' %}"></script>
  <script src="{% static 'js/create_recipe.js' %}"></script>
{% endblock %}
