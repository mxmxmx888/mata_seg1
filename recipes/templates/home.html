{% extends "base.html" %}
{% load static %}

{% block body %}
{% include "partials/navbar.html" %}
<div class="bg-white text-dark">

  <!-- HERO: big heading + large media panel -->
  <section>
    <div class="container-fluid py-5 px-4 px-xl-5">
      <div class="row justify-content-center">
        <div class="col-xxl-10">

          <!-- Main heading + intro -->
          <h1 class="display-3 fw-semibold mb-3 hero-title">
            Proud to serve home cooks.
          </h1>
          <p class="lead text-muted col-lg-7 ps-0 hero-lead">
            Recipi is a simple platform where people save their own recipes,
            discover ideas from others, and follow clear step-by-step instructions
            while they cook.
          </p>

          <!-- Image + supporting copy row -->
          <div class="row align-items-start g-4 mt-4">
            <div class="col-lg-8">
              <!-- Hero image / video placeholder -->
              <div class="ratio ratio-16x9 overflow-hidden bg-light">
                <div class="ratio ratio-1x1 overflow-hidden">
                  <img
                    src="{% static 'img/hero-salad.jpg' %}"
                    class="square-img"
                    alt="One-pan lemon chicken"
                  >
                </div>
              </div>
            </div>

            <div class="col-lg-4 d-flex flex-column justify-content-between">
              <blockquote class="small text-muted mb-4">
                “Recipi becomes the single place where everyone in a household
                or friend group can see what actually works in the kitchen.”
              </blockquote>
              <p class="small text-muted mb-3">
                The system keeps recipes structured but readable, so that time,
                difficulty and ingredients are always visible at a glance.
              </p>
              <a href="#spaces" class="small text-decoration-none fw-semibold">
                Start with the core spaces →
              </a>
            </div>
          </div>

        </div>
      </div>
    </div>
  </section>

  <!-- PLATFORM-LIKE SECTION: core spaces / flows -->
  <section id="spaces" class="home-section-spaces">
    <div class="container-fluid py-5 px-4 px-xl-5">
      <div class="row justify-content-center">
        <div class="col-xxl-10">

          <h2 class="display-5 fw-semibold mb-3">The recipe platform.</h2>
          <p class="text-muted col-lg-7 mb-5">
            We start with a small set of spaces that cover the main flows:
            capturing your own recipes, discovering new ones, and organising them
            for real-world cooking.
          </p>

          <div class="border-top">

            <!-- Space 1 -->
            <div class="row align-items-center py-4 border-bottom">
              <div class="col-md-3 mb-3 mb-md-0">
                <p class="small text-muted mb-1">Space</p>
                <h3 class="h5 mb-0">My recipes</h3>
              </div>
              <div class="col-md-6 mb-3 mb-md-0">
                <p class="small text-muted mb-0">
                  A personal workspace where users create, edit and manage their
                  own recipes with ingredients, timing and step-by-step
                  instructions.
                </p>
              </div>
              <div class="col-md-3 text-md-end">
                <a href="#browse" class="small text-decoration-none">
                  View example list →
                </a>
              </div>
            </div>

            <!-- Space 2 -->
            <div class="row align-items-center py-4 border-bottom">
              <div class="col-md-3 mb-3 mb-md-0">
                <p class="small text-muted mb-1">Space</p>
                <h3 class="h5 mb-0">Browse & search</h3>
              </div>
              <div class="col-md-6 mb-3 mb-md-0">
                <p class="small text-muted mb-0">
                  A community catalogue where users can browse recipes, search by
                  keyword or ingredient, and filter by meal type or difficulty.
                </p>
              </div>
              <div class="col-md-3 text-md-end">
                <a href="#browse" class="small text-decoration-none">
                  Explore how browsing will work →
                </a>
              </div>
            </div>

            <!-- Space 3 -->
            <div class="row align-items-center py-4 border-bottom">
              <div class="col-md-3 mb-3 mb-md-0">
                <p class="small text-muted mb-1">Space</p>
                <h3 class="h5 mb-0">Cooking view</h3>
              </div>
              <div class="col-md-6 mb-3 mb-md-0">
                <p class="small text-muted mb-0">
                  A focused recipe detail layout built for use while cooking,
                  emphasising clear steps, quantities and timings on mobile and
                  desktop.
                </p>
              </div>
              <div class="col-md-3 text-md-end">
                <a href="#browse" class="small text-decoration-none">
                  See a recipe preview →
                </a>
              </div>
            </div>

            <!-- Space 4 (future extension) -->
            <div class="row align-items-center py-4">
              <div class="col-md-3 mb-3 mb-md-0">
                <p class="small text-muted mb-1">Space (extension)</p>
                <h3 class="h5 mb-0">Collections & favourites</h3>
              </div>
              <div class="col-md-6 mb-3 mb-md-0">
                <p class="small text-muted mb-0">
                  Planned extension for saving favourites, building collections
                  (e.g. “Weeknight meals”), and sharing selected recipes with
                  friends or family.
                </p>
              </div>
              <div class="col-md-3 text-md-end">
                <span class="badge text-bg-light text-muted small">
                  Marked as future work
                </span>
              </div>
            </div>

          </div>

        </div>
      </div>
    </div>
  </section>

  <!-- WHY THIS MATTERS / CATEGORY-STYLE SECTION -->
  <section class="home-section-why">
    <div class="container-fluid py-5 border-top px-4 px-xl-5">
      <div class="row justify-content-center">
        <div class="col-xxl-10">

          <p class="small text-muted text-uppercase mb-2">Why this matters</p>
          <h2 class="display-4 fw-semibold mb-4">Designed around how people actually cook.</h2>

          <div class="row g-5">
            <div class="col-md-4">
              <h3 class="h5 mb-2">Structured but human</h3>
              <p class="small text-muted mb-0">
                Recipes are stored with consistent fields (ingredients, method,
                time, difficulty), but presented in natural language so they are
                readable for real cooks, not just the database.
              </p>
            </div>
            <div class="col-md-4">
              <h3 class="h5 mb-2">Fast to search</h3>
              <p class="small text-muted mb-0">
                Simple keyword and ingredient search lets users find something to
                cook based on what they already have in the kitchen.
              </p>
            </div>
            <div class="col-md-4">
              <h3 class="h5 mb-2">Ready for collaboration</h3>
              <p class="small text-muted mb-0">
                The system is designed from the start to support favourites,
                comments and sharing, even if those features are added as later
                iterations.
              </p>
            </div>
          </div>

        </div>
      </div>
    </div>
  </section>

  <!-- LATEST IMPACT / SUPPORTING SECTION -->
  <section>
    <div class="container-fluid py-5 border-top px-4 px-xl-5">
      <div class="row justify-content-center">
        <div class="col-xxl-10">

          <div class="row gy-4 align-items-center mb-5">
            <div class="col-lg-5">
              <div class="ratio ratio-16x9 bg-light border tile-box overflow-hidden impact-hero-frame">
                <img
                  src="{% static 'img/couple-cooking.jpg' %}"
                  class="impact-hero-img"
                  alt="Cooking together in the kitchen"
                >
              </div>
            </div>
            <div class="col-lg-7">
              <p class="small text-muted text-uppercase mb-2">Latest impact</p>
              <h2 class="h3 mb-3">
                Making better use of recipes people already trust.
              </h2>
              <p class="small text-muted mb-3">
                Instead of scattering notes across chat apps and screenshots,
                Recipi pulls recipes into one place where they can be searched,
                reused and refined together.
              </p>
              <a href="#browse" class="small text-decoration-none">
                Browse example recipes →
              </a>
            </div>
          </div>

          <div class="row gy-4 align-items-start">
            <div class="col-lg-4">
              <p class="small text-muted text-uppercase mb-2">Built for</p>
              <div class="d-flex flex-wrap built-for-list mb-3">
                <span class="badge text-bg-dark">Students</span>
                <span class="badge text-bg-dark">Families</span>
                <span class="badge text-bg-dark">Friends</span>
                <span class="badge text-bg-dark">Cooks</span>
              </div>
              <p class="small text-muted mb-0">
                The first version of the platform is scoped for small groups who
                cook at home and want a lightweight way to share what works.
              </p>
            </div>

            <div class="col-lg-8">
              <div class="row g-4">
                <div class="col-md-6">
                  <div class="p-4 bg-light border tile-box">
                    <h3 class="h6 mb-2">During cooking</h3>
                    <p class="small text-muted mb-0">
                      A step-by-step layout with generous spacing, so users can
                      keep the page open on a phone or laptop without losing their
                      place.
                    </p>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="p-4 bg-light border tile-box">
                    <h3 class="h6 mb-2">Planning ahead</h3>
                    <p class="small text-muted mb-0">
                      Filters for time, difficulty and meal type help users plan and prepare
                      what to cook for the whole week, not just tonight.
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </section>

  <!-- BROWSE PREVIEW / MVP HOOK -->
  <section id="browse">
    <div class="container-fluid py-5 pb-5 border-top px-4 px-xl-5">
      <div class="row justify-content-center">
        <div class="col-xxl-10">

          <div class="d-flex flex-wrap justify-content-between align-items-end gap-3 mb-4">
            <div>
              <p class="small text-muted text-uppercase mb-1">Recipe browser preview</p>
              <h2 class="display-4 fw-semibold mb-2">What browsing could look like.</h2>
              <p class="text-muted small mb-0">
                This section will later map directly onto the real “Browse recipes”
                page in the MVP.
              </p>
            </div>
            <a href="{% url 'dashboard' %}" class="btn btn-outline-dark btn-sm cta-browse-btn">
              Open recipe browser (placeholder)
            </a>
          </div>

            <div class="browse-carousel" data-autoplay="true">
              <div class="browse-carousel-viewport">
                <div class="browse-carousel-track">
                <!-- Card 1 -->
                <article class="browse-card tile-box">
                  <p class="small text-muted mb-1">Quick dinner</p>
                  <h3 class="h5 mb-1">One-pan lemon chicken</h3>
                  <p class="small text-muted mb-3">
                    Chicken, potatoes and greens on a single tray for easy cleanup.
                  </p>
                  <p class="small text-muted mb-3">
                    30 min · Easy · Serves 2–3
                  </p>
                  <div class="ratio ratio-1x1 overflow-hidden">
                    <img
                      src="{% static 'img/lemon-chicken.jpg' %}"
                      class="square-img"
                      alt="One-pan lemon chicken"
                    >
                  </div>
                </article>

                <!-- Card 2 -->
                <article class="browse-card tile-box">
                  <p class="small text-muted mb-1">Make ahead</p>
                  <h3 class="h5 mb-1">Slow baked lasagne</h3>
                  <p class="small text-muted mb-3">
                    Layers of pasta, tomato and béchamel for a weekend cook.
                  </p>
                  <p class="small text-muted mb-3">
                    90 min · Medium · Serves 4–6
                  </p>
                  <div class="ratio ratio-1x1 overflow-hidden">
                    <img
                      src="{% static 'img/lasagne.jpg' %}"
                      class="square-img"
                      alt="Slow baked lasagne"
                    >
                  </div>
                </article>

                <!-- Card 3 -->
                <article class="browse-card tile-box">
                  <p class="small text-muted mb-1">Dessert</p>
                  <h3 class="h5 mb-1">Dark chocolate brownies</h3>
                  <p class="small text-muted mb-3">
                    Dense, fudgy brownies with a super short ingredient list.
                  </p>
                  <p class="small text-muted mb-3">
                    45 min · Easy · Serves 8–10
                  </p>
                  <div class="ratio ratio-1x1 overflow-hidden">
                    <img
                      src="{% static 'img/brownies.jpg' %}"
                      class="square-img"
                      alt="Dark chocolate brownies"
                    >
                  </div>
                </article>

                <!-- Card 4 -->
                <article class="browse-card tile-box">
                  <p class="small text-muted mb-1">Breakfast</p>
                  <h3 class="h5 mb-1">Buttermilk pancakes</h3>
                  <p class="small text-muted mb-3">
                    Fluffy weekend pancakes with crispy edges and a touch of vanilla.
                  </p>
                  <p class="small text-muted mb-3">
                    25 min · Easy · Serves 4
                  </p>
                  <div class="ratio ratio-1x1 overflow-hidden">
                    <img
                      src="{% static 'img/pancakes.jpg' %}"
                      class="square-img"
                      alt="Stack of buttermilk pancakes"
                    >
                  </div>
                </article>
              </div>
              <div class="browse-hover-tip" data-visible="false">Next</div>
            </div>
            <div class="browse-carousel-dots" aria-hidden="true"></div>
          </div>

          <script>
            // Lightweight autoplay carousel that keeps sliding forward forever
            // (infinite loop) while centering the active card and showing edge hints.
            document.addEventListener('DOMContentLoaded', function () {
              const carousels = document.querySelectorAll('.browse-carousel');
              if (!carousels.length) return;

              carousels.forEach(function (carousel) {
                const viewport = carousel.querySelector('.browse-carousel-viewport');
                const track = carousel.querySelector('.browse-carousel-track');
                const realSlides = Array.from(track.children); // originals only
                const dotsWrap = carousel.querySelector('.browse-carousel-dots');
                const hoverTip = carousel.querySelector('.browse-hover-tip');
                if (!viewport || !track || !realSlides.length) return;

                // Clone the edges so wrapping is seamless without repeating every card.
                function makeClone(slide) {
                  const clone = slide.cloneNode(true);
                  clone.setAttribute('aria-hidden', 'true');
                  clone.dataset.clone = 'true';
                  return clone;
                }
                const firstClone = makeClone(realSlides[0]);
                const lastClone = makeClone(realSlides[realSlides.length - 1]);
                track.appendChild(firstClone);
                track.insertBefore(lastClone, track.firstChild);

                dotsWrap.innerHTML = realSlides.map(function (_s, idx) {
                  return '<button type="button" class="browse-dot" aria-label="Show slide ' + (idx + 1) + '"></button>';
                }).join('');
                const dots = Array.from(dotsWrap.children);

                const allowAutoplay = carousel.dataset.autoplay === 'true';
                let index = 0;
                let timer = null;
                let scrollTicking = false;
                let spacing = 0;
                let pendingWrap = null;

                function centerOn(el, smooth = true) {
                  const offset = el.offsetLeft - (viewport.clientWidth - el.clientWidth) / 2;
                  viewport.scrollTo({ left: offset, behavior: smooth ? 'smooth' : 'auto' });
                }

                function positionFor(el) {
                  return el.offsetLeft - (viewport.clientWidth - el.clientWidth) / 2;
                }

                function markActive(realIndex) {
                  realSlides.forEach(function (slide, i) {
                    slide.classList.toggle('is-active', i === realIndex);
                  });
                  dots.forEach(function (dot, i) {
                    dot.classList.toggle('is-active', i === realIndex);
                  });
                }

                function measureSpacing() {
                  if (realSlides.length > 1) {
                    return realSlides[1].offsetLeft - realSlides[0].offsetLeft;
                  }
                  const styles = getComputedStyle(track);
                  const gapValue = parseFloat(styles.columnGap || styles.gap || '0');
                  return realSlides[0].clientWidth + gapValue;
                }

                function goTo(targetIndex, smooth = true) {
                  const boundedIndex = ((targetIndex % realSlides.length) + realSlides.length) % realSlides.length;
                  let targetSlide;
                  if (targetIndex >= realSlides.length) {
                    targetSlide = firstClone;
                    pendingWrap = 'first';
                  } else if (targetIndex < 0) {
                    targetSlide = lastClone;
                    pendingWrap = 'last';
                  } else {
                    targetSlide = realSlides[boundedIndex];
                    pendingWrap = null;
                  }

                  centerOn(targetSlide, smooth);
                  index = boundedIndex;
                  markActive(index);
                }

                function wrapIfNeeded() {
                  if (!spacing) return;
                  const scrollLeft = viewport.scrollLeft;
                  const firstClonePos = positionFor(firstClone);
                  const lastClonePos = positionFor(lastClone);
                  const threshold = spacing * 0.6;

                  if (Math.abs(scrollLeft - firstClonePos) <= threshold) {
                    centerOn(realSlides[0], false);
                    index = 0;
                    markActive(index);
                    pendingWrap = null;
                    return;
                  }

                  if (Math.abs(scrollLeft - lastClonePos) <= threshold) {
                    centerOn(realSlides[realSlides.length - 1], false);
                    index = realSlides.length - 1;
                    markActive(index);
                    pendingWrap = null;
                    return;
                  }

                  if (pendingWrap === 'first' && scrollLeft > firstClonePos) {
                    centerOn(realSlides[0], false);
                    pendingWrap = null;
                  } else if (pendingWrap === 'last' && scrollLeft < lastClonePos) {
                    centerOn(realSlides[realSlides.length - 1], false);
                    pendingWrap = null;
                  }
                }

                function syncActiveFromScroll() {
                  const scrollLeft = viewport.scrollLeft;
                  let closestIndex = index;
                  let smallestDelta = Infinity;

                  realSlides.forEach(function (slide, i) {
                    const delta = Math.abs(positionFor(slide) - scrollLeft);
                    if (delta < smallestDelta) {
                      smallestDelta = delta;
                      closestIndex = i;
                    }
                  });

                  if (closestIndex !== index) {
                    index = closestIndex;
                    markActive(index);
                  }
                }

                function startAutoplay() {
                  if (!allowAutoplay) return;
                  if (timer) return;
                  timer = setInterval(function () {
                    goTo(index + 1);
                  }, 5200);
                }

                function stopAutoplay() {
                  clearInterval(timer);
                  timer = null;
                }

                dots.forEach(function (dot, idx) {
                  dot.addEventListener('click', function () {
                    stopAutoplay();
                    goTo(idx);
                    startAutoplay();
                  });
                });

                viewport.addEventListener('mouseenter', function () {
                  stopAutoplay();
                  if (hoverTip) hoverTip.dataset.visible = 'true';
                });

                viewport.addEventListener('mouseleave', function () {
                  startAutoplay();
                  if (hoverTip) hoverTip.dataset.visible = 'false';
                });

                viewport.addEventListener('pointerdown', stopAutoplay);
                viewport.addEventListener('pointerup', startAutoplay);
                viewport.addEventListener('touchstart', stopAutoplay, { passive: true });
                viewport.addEventListener('touchend', startAutoplay, { passive: true });

                viewport.addEventListener('mousemove', function (evt) {
                  if (!hoverTip) return;
                  const rect = viewport.getBoundingClientRect();
                  const isNext = evt.clientX >= rect.left + rect.width / 2;
                  hoverTip.textContent = isNext ? 'Next' : 'Previous';
                  const x = evt.clientX - rect.left;
                  const y = evt.clientY - rect.top;
                  hoverTip.style.transform = 'translate(' + x + 'px,' + (y - 18) + 'px)';
                  hoverTip.dataset.side = isNext ? 'next' : 'prev';
                });

                viewport.addEventListener('click', function (evt) {
                  const rect = viewport.getBoundingClientRect();
                  const isNext = evt.clientX >= rect.left + rect.width / 2;
                  stopAutoplay();
                  goTo(isNext ? index + 1 : index - 1);
                  startAutoplay();
                });

                viewport.addEventListener('scroll', function () {
                  if (scrollTicking) return;
                  scrollTicking = true;
                  requestAnimationFrame(function () {
                    wrapIfNeeded();
                    syncActiveFromScroll();
                    scrollTicking = false;
                  });
                });

                window.addEventListener('resize', function () {
                  goTo(index, false);
                  wrapIfNeeded();
                });

                requestAnimationFrame(function () {
                  spacing = measureSpacing();
                  goTo(0, false);
                  wrapIfNeeded();
                  if (carousel.dataset.autoplay === 'true') {
                    startAutoplay();
                  }
                });
              });
            });
          </script>

        </div>
      </div>
    </div>
  </section>

   <!-- FOOTER -->
   <section class="border-top pt-5 pb-0 mt-5 bg-white">
    <div class="container-fluid px-4 px-xl-5">
      <div class="row justify-content-center">
        <div class="col-xxl-10">

          <!-- Top row: CTA -->
          <div class="d-flex flex-wrap justify-content-between align-items-center gap-3 mb-5">
            <div>
              <!-- Big CTA, almost hero-sized -->
              <h2 class="display-4 fw-semibold mb-2 footer-cta-title">Get started now!</h2>
              <p class="lead text-muted mb-0">
                Start saving recipes, sharing ideas and cooking together.
              </p>
            </div>
            <a href="{% url 'sign_up' %}" class="btn btn-lg btn-outline-dark">
              Get started →
            </a>
          </div>

          <!-- Bottom row: meta + link columns -->
          <div class="row gy-4 footer-links-row">

            <!-- Left: brand + social (horizontal) -->
            <div class="col-lg-3">
              <p class="small text-muted mb-1">© 2025 Recipi.</p>
              <p class="small text-muted mb-3">All rights reserved.</p>

              <div class="d-flex flex-wrap gap-2">
                <button type="button" class="btn btn-sm btn-outline-secondary">Instagram</button>
                <button type="button" class="btn btn-sm btn-outline-secondary">TikTok</button>
                <button type="button" class="btn btn-sm btn-outline-secondary">YouTube</button>
              </div>
            </div>

            <!-- Right: link columns -->
            <div class="col-lg-9">
              <div class="row gy-4">
                <div class="col-6 col-md-3">
                  <p class="small text-muted text-uppercase mb-2">Product</p>
                  <p class="small mb-1"><a href="#" class="text-decoration-none text-muted">Overview</a></p>
                  <p class="small mb-1"><a href="#" class="text-decoration-none text-muted">My recipes</a></p>
                  <p class="small mb-1"><a href="#" class="text-decoration-none text-muted">Browse recipes</a></p>
                  <p class="small mb-0"><a href="#" class="text-decoration-none text-muted">Cooking view</a></p>
                </div>

                <div class="col-6 col-md-3">
                  <p class="small text-muted text-uppercase mb-2">For home cooks</p>
                  <p class="small mb-1"><a href="#" class="text-decoration-none text-muted">Families</a></p>
                  <p class="small mb-1"><a href="#" class="text-decoration-none text-muted">Students</a></p>
                  <p class="small mb-0"><a href="#" class="text-decoration-none text-muted">Friend groups</a></p>
                </div>

                <div class="col-6 col-md-3">
                  <p class="small text-muted text-uppercase mb-2">Features</p>
                  <p class="small mb-1"><a href="#" class="text-decoration-none text-muted">Search by ingredient</a></p>
                  <p class="small mb-1"><a href="#" class="text-decoration-none text-muted">Tags & filters</a></p>
                  <p class="small mb-1"><a href="#" class="text-decoration-none text-muted">Collections</a></p>
                  <p class="small mb-0"><a href="#" class="text-decoration-none text-muted">Sharing</a></p>
                </div>

                <div class="col-6 col-md-3">
                  <p class="small text-muted text-uppercase mb-2">About</p>
                  <p class="small mb-1"><a href="#" class="text-decoration-none text-muted">Project brief</a></p>
                  <p class="small mb-1"><a href="#" class="text-decoration-none text-muted">Team</a></p>
                  <p class="small mb-0"><a href="#" class="text-decoration-none text-muted">Privacy & terms</a></p>
                </div>
              </div>
            </div>

          </div>

        </div>
      </div>
    </div>
  </section>

  <!-- Giant Recipi wordmark -->
  <div class="footer-giant-logo text-center">
    Recipi
  </div>


</div>
{% endblock body %}
